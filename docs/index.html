<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>顔ランダム抽選</title>

  <script type="module" crossorigin src="/face-lottery/assets/index-BhwxQc9q.js"></script>
  <link rel="stylesheet" crossorigin href="/face-lottery/assets/index-BGiW2CG3.css">
</head>

<body>
  <div class="app">
    <header class="header">
      <div class="title">顔ランダム抽選</div>

      <!-- 右上：状態 + SEトグル（状態の一部） -->
      <div id="status" class="status" aria-live="polite">
        <span id="statusText">カメラを開始してください</span>

        <button
          id="seToggle"
          class="status-icon-btn"
          type="button"
          aria-label="効果音オン"
          title="効果音オン/オフ"
        >
          <!-- volume on -->
          <svg id="seIconOn" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M11 5L6.5 9H3v6h3.5L11 19V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M15.5 8.5C16.7 9.7 16.7 14.3 15.5 15.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M18.5 6.5C20.8 8.8 20.8 15.2 18.5 17.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>

          <!-- volume off -->
          <svg id="seIconOff" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="display:none;">
            <path d="M11 5L6.5 9H3v6h3.5L11 19V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M15 9l6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M21 9l-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </header>

    <div class="description">
      カメラに映っている人の中から、ランダムで1人を選びます。
    </div>

    <!-- 左：カメラ操作 / 中央：抽選 -->
    <div class="controls controls-b">
      <div class="row row-camera">
        <button id="toggleCamera" class="btn btn-primary">カメラ開始</button>

        <button
          id="switchCam"
          class="btn btn-ghost btn-icon"
          disabled
          aria-label="カメラ切り替え"
          title="カメラ切り替え"
        >
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M9 7H7.7c-.5 0-1 .3-1.2.7L5.6 9H4.5C3.7 9 3 9.7 3 10.5v7C3 18.3 3.7 19 4.5 19h15c.8 0 1.5-.7 1.5-1.5v-7C21 9.7 20.3 9 19.5 9h-1.1l-.9-1.3c-.2-.4-.7-.7-1.2-.7H15"
              stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 13h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M10 11l-2 2 2 2" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M16 11l2 2-2 2" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <div class="row row-spin">
        <button id="spin" class="btn btn-accent btn-main" disabled>抽選開始</button>

        <div id="resultUI" class="result-ui" style="display:none;">
          <button id="back" class="btn btn-ghost">戻る</button>
        </div>
      </div>
    </div>

    <div id="stage" class="stage">
      <video id="video" autoplay playsinline muted></video>
      <canvas id="overlay" class="layer"></canvas>
      <canvas id="resultCanvas" class="layer" style="display:none;"></canvas>
      <div id="resultText" class="result-text" style="display:none;"></div>
    </div>

    <footer class="footer">
      Safari(iOS)ではカメラの許可が必要です
    </footer>
  </div>

</body>
</html>
